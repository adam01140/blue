<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Forms - FormWiz</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            display: flex;
            flex-direction: column;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            color: #333;
            background-color: #f4f4f4;
        }
        header {
            background-color: #2c3e50;
            padding: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        header img {
            position: absolute;
            left: 20px;
            cursor: pointer;
        }
        nav {
            display: flex;
            justify-content: center;
        }
        nav a {
            margin: 0 15px;
            color: #ffffff;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        nav a:hover {
            color: #2980b9;
        }
        section {
            padding: 50px;
            text-align: center;
            flex: 1;
        }
        section h1 {
            color: #2980b9;
            text-align: center;
            margin-bottom: 30px;
        }
        section ul {
            list-style: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        section ul li {
            margin: 10px;
            width: 150px;
            height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #2980b9;
            border-radius: 5px;
            background-color: #EBE7D9;
            transition: background-color 0.3s ease;
            box-sizing: border-box;
            padding: 10px;
            text-align: center;
        }
        section ul li:hover {
            background-color: #3498db;
        }
        section ul li a {
            color: #2980b9;
            text-decoration: none;
            font-weight: bold;
            display: block;
            width: 100%;
        }
        section ul li:hover a {
            color: #EBE7D9;
        }
        footer {
            text-align: center;
            padding: 20px;
            background-color: #2c3e50;
            color: #EBE7D9;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <header>
        <img src="logo.png" alt="FormWiz Logo" width="130" height="80" onclick="location.href='index.html';">
        <nav>
            <a href="index.html">Home</a>
            <a href="forms.html">Forms</a>
            <a href="contact.html">Contact Us</a>
        </nav>
    </header>

    <!-- My Forms Section -->
    <section class="forms-section">
        <h1>My Forms</h1>
        <ul id="my-forms-list" class="forms-list">
            <!-- User's forms will be dynamically inserted here -->
        </ul>
    </section>

    <!-- Available Forms Section -->
    <section class="forms-section">
        <h1>Available Forms</h1>
        <ul id="available-forms-list" class="forms-list">
            <li><a href="#" data-form-id="fee-waiver" data-form-url="fee-waiver.html?formId=fee-waiver">Court Fees Waiver</a></li>
            <li><a href="#" data-form-id="form-filler" data-form-url="form-filler.html?formId=form-filler">Developer GUI</a></li>
            <li><a href="#" data-form-id="example" data-form-url="example.html?formId=example">Example</a></li>
            <li><a href="#" data-form-id="example2" data-form-url="example2.html?formId=example2">Example2</a></li>
            <li><a href="#" data-form-id="form5" data-form-url="form5.html?formId=form5">Form 5</a></li>
            <!-- Add more forms as needed -->
        </ul>
    </section>

    <footer>
        &copy; 2024 FormWiz. All rights reserved.
    </footer>

    <!-- Include Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDS-tSSn7fdLBgwzfHQ_1MPG1w8S_4qb04",
            authDomain: "formwiz-3f4fd.firebaseapp.com",
            projectId: "formwiz-3f4fd",
            storageBucket: "formwiz-3f4fd.appspot.com",
            messagingSenderId: "404259212529",
            appId: "1:404259212529:web:15a33bce82383b21cfed50",
            measurementId: "G-P07YEN0HPD"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();

        // Check if user is authenticated
        firebase.auth().onAuthStateChanged((user) => {
            if (user) {
                // User is signed in, proceed to fetch and display forms
                const userId = user.uid;
                const myFormsList = document.getElementById('my-forms-list');
                const availableFormsList = document.getElementById('available-forms-list');

                // Function to render My Forms
                function renderMyForms(forms) {
                    myFormsList.innerHTML = ''; // Clear existing forms
                    forms.forEach((form) => {
                        const li = document.createElement('li');
                        const a = document.createElement('a');
                        a.href = form.url;
                        a.textContent = form.name;
                        li.appendChild(a);
                        myFormsList.appendChild(li);
                    });
                }

                // Fetch user's forms from Firestore
                db.collection('users').doc(userId).collection('myForms').get()
                    .then((querySnapshot) => {
                        const forms = [];
                        querySnapshot.forEach((doc) => {
                            forms.push(doc.data());
                        });
                        renderMyForms(forms);
                    })
                    .catch((error) => {
                        console.error('Error fetching user forms:', error);
                    });

                // Add click event listeners to available forms
                availableFormsList.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (e.target && e.target.nodeName === 'A') {
                        const formId = e.target.getAttribute('data-form-id');
                        const formUrl = e.target.getAttribute('data-form-url');
                        const formName = e.target.textContent;

                        // Add form to user's My Forms in Firestore
                        db.collection('users').doc(userId).collection('myForms').doc(formId).set({
                            name: formName,
                            url: formUrl
                        })
                        .then(() => {
                            // Update My Forms section
                            const li = document.createElement('li');
                            const a = document.createElement('a');
                            a.href = formUrl;
                            a.textContent = formName;
                            li.appendChild(a);
                            myFormsList.appendChild(li);
                        })
                        .catch((error) => {
                            console.error('Error adding form to My Forms:', error);
                        });
                    }
                });
            } else {
                // No user is signed in, redirect to login page
                window.location.href = 'account.html';
            }
        });
    </script>

</body>
</html>
