<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Connection Form</title>
  <style>
    :root{
      --bg1:#eef3ff;
      --bg2:#ffffff;
      --card:#ffffffcc;
      --ink:#0f172a;
      --muted:#5b6475;
      --accent:#0A66C2;
      --accent-2:#6aa9ff;
      --ring:#0a66c23d;
      --line:#e6eaf1;
      --ok:#22c55e;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Helvetica Neue", Helvetica, sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1100px 700px at 20% -10%, #dfeaff 0%, #f6f9ff 45%, #ffffff 70%) no-repeat,
        linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
      padding:32px 20px;
    }

    .page{
      max-width:1050px;
      margin:0 auto;
    }

    .form-shell{
      background:var(--card);
      backdrop-filter:saturate(1.2) blur(8px);
      border:1px solid var(--line);
      border-radius:18px;
      box-shadow: 0 10px 30px rgba(16,24,40,.08);
      overflow:hidden;
    }

    header.hero{
      padding:28px 28px 18px;
      background:
        linear-gradient(180deg, #ffffffcc, #ffffffaa),
        radial-gradient(1200px 600px at 80% -40%, #b8d8ff55, transparent 60%),
        radial-gradient(900px 500px at 0% 0%, #9fd3ff44, transparent 60%);
      border-bottom:1px solid var(--line);
    }
    .title{
      margin:0 0 6px;
      font-size:28px;
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size:14.5px;
    }

    form{
      padding:26px;
    }

    .section{
      border:1px solid var(--line);
      border-radius:14px;
      padding:18px;
      margin-bottom:16px;
      background:#fff;
    }
    .section h2{
      margin:0 0 14px;
      font-size:15px;
      font-weight:700;
      color:#0b2a52;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .section h2::before{
      content:"";
      width:8px;height:8px;border-radius:999px;background:var(--accent);
      box-shadow:0 0 0 4px #0a66c21f;
    }

    .grid{
      display:grid;
      gap:14px;
    }
    /* responsive columns */
    .cols-2{grid-template-columns: repeat(2,minmax(0,1fr));}
    .cols-3{grid-template-columns: repeat(3,minmax(0,1fr));}
    .cols-4{grid-template-columns: repeat(4,minmax(0,1fr));}
    @media (max-width:980px){ .cols-4{grid-template-columns: repeat(3,minmax(0,1fr));} }
    @media (max-width:780px){
      .cols-4,.cols-3{grid-template-columns: repeat(2,minmax(0,1fr));}
    }
    @media (max-width:520px){
      .cols-4,.cols-3,.cols-2{grid-template-columns: 1fr;}
    }

    .field{
      display:flex; flex-direction:column; gap:6px;
    }
    label{
      font-size:12.5px;
      color:#334155;
      font-weight:600;
      letter-spacing:.15px;
    }
    input[type="text"],
    input[type="tel"],
    input[type="number"],
    input[type="date"],
    input[type="email"],
    textarea,
    select{
      width:100%;
      padding:12px 12px;
      border:1px solid var(--line);
      border-radius:10px;
      background:#fff;
      font-size:14.5px;
      outline:none;
      transition:.15s border, .15s box-shadow;
    }
    textarea{min-height:92px; resize:vertical;}
    input:focus, textarea:focus, select:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 4px var(--ring);
    }

    .inline{
      display:flex; gap:14px; flex-wrap:wrap; align-items:center;
    }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border:1px solid var(--line); border-radius:999px; background:#fff;
      font-size:13.5px;
    }
    .chip input{transform:translateY(1px)}
    .muted{ color:var(--muted); font-size:12.5px;}

    .submit-btn{
      background:linear-gradient(180deg, var(--accent), #08498f);
      color:#fff; border:none; border-radius:12px;
      padding:14px 18px; font-size:16px; font-weight:700; letter-spacing:.2px;
      cursor:pointer; width:100%; margin-top:6px;
      box-shadow:0 8px 18px rgba(10,102,194,.22);
    }
    .submit-btn:hover{filter:brightness(1.05)}
    .submit-btn:disabled{background:#9dbbe2; box-shadow:none; cursor:not-allowed}

    .thank-you{
      display:none; text-align:center; padding:34px 26px;
    }
    .thank-you h2{ color:var(--ok); margin:0 0 10px; }
    .download-btn{
      background:#22c55e; color:#fff; border:none; border-radius:12px; padding:12px 20px;
      font-size:15px; cursor:pointer; margin-top:10px;
      box-shadow:0 8px 18px rgba(34,197,94,.22);
    }
    .download-btn:hover{filter:brightness(1.05)}
    .download-btn:disabled{background:#a7d9b8; box-shadow:none; cursor:not-allowed}
  </style>
</head>
<body>
  <div class="page">
    <div class="form-shell">
      <header class="hero">
        <h1 class="title">Connection Form</h1>
        <p class="subtitle">Enter the customer and service details below. When you submit, you’ll be able to download a nicely formatted PDF.</p>
      </header>

      <!-- Keep the same IDs and JS behavior -->
      <form id="customForm" onsubmit="return handleSubmit(event);">

        <div class="form-group">
            <label for="user_phone">What's your number?</label>
            <input type="tel" id="user_phone" name="user_phone" placeholder="Enter your phone number" required>
        </div>
        <!-- Top line -->
        <div class="section">
          <h2>Header</h2>
          <div class="grid cols-4">
            <div class="field"><label for="date">Date</label><input type="date" id="date" name="date"></div>
            <div class="field"><label for="account_number">Account #</label><input type="text" id="account_number" name="account_number" placeholder="e.g., 123456"></div>
            <div class="field"><label for="wo_number">W/O #</label><input type="text" id="wo_number" name="wo_number" placeholder="Work order"></div>
            <div class="field"><label for="cycle_number">Cycle #</label><input type="text" id="cycle_number" name="cycle_number" placeholder="e.g., 3"></div>
          </div>
        </div>

        <!-- Addresses & Service Type -->
        <div class="section">
          <h2>Service & Mailing</h2>
          <div class="grid cols-2">
            <div class="field"><label for="service_address">Service Address</label><input type="text" id="service_address" name="service_address" placeholder="Street, City, State, ZIP"></div>
            <div class="field"><label for="mailing_address">Mailing Address</label><input type="text" id="mailing_address" name="mailing_address" placeholder="Street, City, State, ZIP"></div>
          </div>
          <div class="inline" style="margin-top:10px">
            <span class="muted">Service Type:</span>
            <label class="chip"><input type="radio" name="service_type" value="residential_single"> RESL Single</label>
            <label class="chip"><input type="radio" name="service_type" value="residential_multi"> Multi</label>
            <label class="chip"><input type="radio" name="service_type" value="commercial"> Commercial</label>
          </div>
        </div>

        <!-- Proof of Occupancy -->
        <div class="section">
          <h2>Occupancy Documents</h2>
          <div class="inline">
            <label class="chip"><input type="checkbox" name="doc_rental" value="yes"> Rental agreement (1st page)</label>
            <label class="chip"><input type="checkbox" name="doc_rental_spanish" value="yes"> Contrato de Inquilino</label>
            <label class="chip"><input type="checkbox" name="doc_purchase" value="yes"> Purchase – Closing/Est. Closing Costs</label>
            <label class="chip"><input type="checkbox" name="doc_purchase_spanish" value="yes"> Cierra de Trato – Título</label>
          </div>
        </div>

        <!-- Customer -->
        <div class="section">
          <h2>Customer</h2>
          <div class="grid cols-3">
            <div class="field"><label for="first_name">First Name</label><input type="text" id="first_name" name="first_name"></div>
            <div class="field"><label for="middle_ex">MI / Ex</label><input type="text" id="middle_ex" name="middle_ex" placeholder="Optional"></div>
            <div class="field"><label for="last_name">Last Name</label><input type="text" id="last_name" name="last_name"></div>
          </div>
          <div class="grid cols-3" style="margin-top:6px">
            <div class="field"><label for="verify_cadl">Verify CADL / ID #</label><input type="text" id="verify_cadl" name="verify_cadl" placeholder="ID or CADL #"></div>
            <div class="field"><label for="last4_ssn">Last 4 SS#</label><input type="text" id="last4_ssn" name="last4_ssn" maxlength="4" inputmode="numeric" pattern="[0-9]{4}" placeholder="XXXX"></div>
            <div class="field"><label for="connect_date">Connect Date</label><input type="date" id="connect_date" name="connect_date"></div>
          </div>

          <div class="inline" style="margin-top:8px">
            <span class="muted">Last Bill?</span>
            <label class="chip"><input type="checkbox" name="last_bill" value="yes"> Yes</label>
            <span class="muted" style="margin-left:10px;">Day of Week:</span>
            <label class="chip"><input type="radio" name="last_bill_dow" value="MON"> MON</label>
            <label class="chip"><input type="radio" name="last_bill_dow" value="TUE"> TUE</label>
            <label class="chip"><input type="radio" name="last_bill_dow" value="WED"> WED</label>
            <label class="chip"><input type="radio" name="last_bill_dow" value="THU"> THU</label>
            <label class="chip"><input type="radio" name="last_bill_dow" value="FRI"> FRI</label>
          </div>

          <div class="grid cols-2" style="margin-top:10px">
            <div class="field"><label for="contact_phone">Contact #</label><input type="tel" id="contact_phone" name="contact_phone" placeholder="(xxx) xxx-xxxx"></div>
            <div class="field"><label for="emergency_phone">Emergency Contact #</label><input type="tel" id="emergency_phone" name="emergency_phone" placeholder="(xxx) xxx-xxxx"></div>
          </div>

          <div class="grid cols-3" style="margin-top:10px">
            <div class="field"><label for="employer">Employer</label><input type="text" id="employer" name="employer"></div>
            <div class="field"><label for="last_bill_date">Last Bill Date</label><input type="date" id="last_bill_date" name="last_bill_date"></div>
            <div class="field"><label for="email">Email (optional)</label><input type="email" id="email" name="email" placeholder="name@example.com"></div>
          </div>
        </div>

        <!-- Previous Address -->
        <div class="section">
          <h2>Previous Address</h2>
          <div class="grid">
            <div class="field">
              <label for="previous_address">Domicilio Anterior</label>
              <textarea id="previous_address" name="previous_address" placeholder="Street, City, State, ZIP"></textarea>
            </div>
          </div>
        </div>

        <!-- Deposit / Payment -->
        <div class="section">
          <h2>Deposit & Payment</h2>
          <div class="grid cols-3">
            <div class="field"><label for="deposit_amount">Deposit</label><input type="number" id="deposit_amount" name="deposit_amount" step="0.01" value="150"></div>
            <div class="field">
              <label>Payment Method</label>
              <div class="inline">
                <label class="chip"><input type="radio" name="payment_method" value="cash"> Cash</label>
                <label class="chip"><input type="radio" name="payment_method" value="check"> Check</label>
              </div>
            </div>
            <div class="field"><label for="check_number">Check #</label><input type="text" id="check_number" name="check_number" placeholder="If paid by check"></div>
          </div>
        </div>

        <!-- Work Order & Reads -->
        <div class="section">
          <h2>Work Order & Reads</h2>
          <div class="inline">
            <label class="chip"><input type="checkbox" name="wo" value="yes"> W/O</label>
            <label class="chip"><input type="checkbox" name="connect" value="yes"> Connect</label>
            <label class="chip"><input type="checkbox" name="disconnect" value="yes"> Disconnect</label>
            <label class="chip"><input type="checkbox" name="receipt" value="yes"> Receipt</label>
            <label class="chip"><input type="checkbox" name="refund_wo" value="yes"> Refund W/O</label>
          </div>
          <div class="grid cols-3" style="margin-top:10px">
            <div class="field"><label for="last_read">Last Read</label><input type="number" id="last_read" name="last_read" step="1"></div>
            <div class="field"><label for="current_read">Current Read</label><input type="number" id="current_read" name="current_read" step="1"></div>
            <div class="field"><label for="refund_issued">Refund Issued $</label><input type="number" id="refund_issued" name="refund_issued" step="0.01"></div>
          </div>
          <div class="grid cols-2" style="margin-top:10px">
            <div class="field"><label for="form_date">Date</label><input type="date" id="form_date" name="form_date"></div>
            <div class="field"><label for="notes">Notes (optional)</label><input type="text" id="notes" name="notes" placeholder="Any additional details"></div>
          </div>
        </div>

        <!-- Submit -->
        <button type="submit" class="submit-btn">Submit</button>
      </form>

      <!-- Thank you state (unchanged) -->
      <div id="thankYouMessage" class="thank-you">
        <h2>Thank you!</h2>
        <p>Your form has been submitted successfully.</p>
        <button id="downloadBtn" class="download-btn" onclick="downloadPDF()">Download PDF</button>
      </div>
    </div>
  </div>

  <script>
    // Form submission handler (kept as-is)
    function handleSubmit(event) {
      event.preventDefault();
      document.getElementById('customForm').style.display = 'none';
      document.getElementById('thankYouMessage').style.display = 'block';
      return false;
    }

    // PDF download function (kept as-is)
    async function downloadPDF() {
      const downloadBtn = document.getElementById('downloadBtn');
      const originalText = downloadBtn.textContent;
      try{
        downloadBtn.textContent='Processing...';
        downloadBtn.disabled=true;

        const formData = new FormData(document.getElementById('customForm'));
        const response = await fetch('/edit_pdf?pdf=form1', { method:'POST', body:formData });
        if(!response.ok) throw new Error('Server error: '+response.status);

        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href=url; a.download='form1.pdf';
        document.body.appendChild(a); a.click(); document.body.removeChild(a);
        URL.revokeObjectURL(url);

        downloadBtn.textContent='Download Complete!';
        setTimeout(()=>{ downloadBtn.textContent=originalText; downloadBtn.disabled=false; }, 2000);
      }catch(err){
        console.error('Error downloading PDF:', err);
        downloadBtn.textContent='Error - Try Again';
        downloadBtn.disabled=false;
        setTimeout(()=>{ downloadBtn.textContent=originalText; }, 2000);
      }
    }
  </script>
</body>
</html>
